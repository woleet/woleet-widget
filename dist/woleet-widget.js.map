{"version":3,"sources":["woleet-widget.js"],"names":["root","Widget","hash","Error","state","defineProperty","target","name","value","Object","enumerable","$","element","Element","TypeError","self","rts","def","attr","val","setAttribute","removeAttribute","e","Array","isArray","forEach","classList","remove","add","text","innerText","innerHTML","url","removeClass","addClass","props","map","p","style","prop","type","listener","capture","addEventListener","elt","appendChild","toDom","err","console","warn","$touch","c","d","document","createElement","widget","head","logo","x","receipt","on","forceReceipt","reset","cancel","cancelHash","body","hashZone","hashProgessContainer","percentage","progressBar","infoZone","items","item","mainTextZone","subTextZone","byTextZone","signTextZone","identityTextZone","warnTextZone","selectItem","push","html","dropZone","inputContainer","input","setInputFile","foot","expand","expandList","init","call","files","resetText","hide","show","clear","flush","formatDate","date","options","year","month","day","hour","minute","toLocaleDateString","hasher","woleet","file","Hasher","setVue","setProgress","progress","toFixed","width","parseReceiptFile","then","verify","DAB","res","code","catch","woleetDAB","WoleetDAB","results","addResults","sort","b","a","timestamp","hasOwnProperty","message","Promise","resolve","reject","start","error","r","result","getDetailedMessage","detail","main","sub","trace","length","i","addVue","vue","index","addItem","sig","signature","pubKey","confirmations","idStatus","identityVerificationStatus","identity","assign","signedIdentity","identityURL","link","encodeURIComponent","commonName","organization","organizationalUnit","locality","country","reader","FileReader","onloadend","JSON","parse","readAsText","expanded","selected","ctx","setReceipt","widgets","getElementsByClassName","getAttribute","window"],"mappings":"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","sourcesContent":["(function (root) {\n\n  /**\n   * @param [hash]\n   * @constructor\n   */\n  function Widget(hash) {\n\n    // Check parameter\n    if (hash && typeof hash !== 'string')\n      throw new Error('Invalid parameter type');\n\n    // Init state\n    const state = {\n      state: 'initial',\n      hash: null\n    };\n\n    /**\n     * @typedef {{\n     *      target:function(),\n     *      addClass: function(string[]|string):$,\n     *      removeClass: function(string[]|string):$,\n     *      show: function():$,\n     *      hide: function():$,\n     *      text: function(text: string, add?: boolean):$,\n     *      html: function(text: string, add?: boolean):$,\n     *      link: function(link: string):$,\n     *      clear: function():$,\n     *      style: function(props: object),\n     *      attr: function(attr: string, val: *),\n     *      on: function(type: string, listener:function, capture: boolean),\n     *      toDom: function()\n     *      }} $\n     */\n\n    const defineProperty = (target) => (name, value) => Object.defineProperty(target, name, {\n      enumerable: false,\n      value\n    });\n\n    /**\n     * @description \"virtual\" DOM element Object\n     * @param {Element|string} element\n     * @private\n     */\n    const $ = function (element) {\n\n      if ((!element instanceof Element)) {\n        throw new TypeError;\n      }\n\n      const target = element;\n      /**\n       * @type {$}\n       */\n      const self = this;\n      const rts = () => self;\n      const def = defineProperty(this);\n\n      def('target', () => target);\n      def('attr', (attr, val) => rts(val ? target.setAttribute(attr, val) : target.removeAttribute(attr)));\n      def('removeClass', (e) => rts(Array.isArray(e) ? e.forEach(e => target.classList.remove(e)) : target.classList.remove(e)));\n      def('addClass', (e) => rts(Array.isArray(e) ? e.forEach(e => target.classList.add(e)) : target.classList.add(e)));\n      def('text', (text, add) => rts(add ? target.innerText += text : target.innerText = text));\n      def('html', (text, add) => rts(add ? target.innerHTML += text : target.innerHTML = text));\n      def('link', (url) => rts(self.text(url).attr('href', url)));\n      def('clear', () => rts(self.text(''), self.attr('href', null)));\n      def('show', () => self.removeClass('hidden'));\n      def('hide', () => self.addClass('hidden'));\n      def('style', (props) => {\n        if (Array.isArray(props)) {\n          return props.map((p) => target.style[p])\n        } else if (typeof props === 'string') {\n          return target.style[props];\n        } else {\n          for (let prop in props) {\n            target.style[prop] = props[prop];\n          }\n        }\n      });\n      def('on', (type, listener, capture) => rts(target.addEventListener(type, listener, capture)));\n      def('toDom', () => {\n        let root = self.target();\n        for (let e in self) {\n          const elt = self[e];\n          try {\n            if (Array.isArray(elt))\n              elt.forEach((e) => root.appendChild(e.toDom()));\n            else\n              root.appendChild(elt.toDom())\n          }\n          catch (err) {\n            console.warn(e, target, self[e], err);\n          }\n        }\n        return root;\n      });\n    };\n\n    /**\n     * @description \"virtual\" DOM element factory\n     * @param {String} [e] element type\n     * @param {String|Array<String>} [c] class/classes\n     */\n    const $touch = (e = 'div', c) => {\n      let d = new $(document.createElement(e));\n      if (c) d.addClass(c);\n      return d;\n    };\n\n    // Build the \"virtual\" widget\n    const widget = $touch('div', 'widget');\n    const head = widget.head = $touch('div', 'head');\n    head.logo = $touch('div', 'woleet-logo');\n\n    head.x = $touch('div', 'floatright');\n    head.x.receipt = $touch('button', ['receipt-button', 'clickable']).on('click', forceReceipt).text('Drop proof');\n    head.x.reset = $touch('div', ['reset', 'mini-button', 'clickable']).on('click', reset);\n    head.x.cancel = $touch('div', ['cancel', 'mini-button', 'clickable']).on('click', cancelHash);\n\n    const body = widget.body = $touch('div', 'body');\n\n    const hashZone = body.hashZone = $touch('div', 'hashZone');\n    hashZone.hashProgessContainer = $touch('div', 'progressBarContainer');\n    hashZone.percentage = $touch('span').text('Hashing... 0%');\n    const progressBar = hashZone.hashProgessContainer.progressBar = $touch('div', 'progressBar');\n\n    const infoZone = body.infoZone = $touch('div', 'infoZone');\n    infoZone.items = [];\n    defineProperty(infoZone)('addItem', function () {\n      const item = $touch('div', 'infoZoneItem');\n      item.mainTextZone = $touch('div', ['text', 'small']);\n      item.subTextZone = $touch('div', ['text', 'x-small']);\n      item.byTextZone = $touch('span', ['text', 'x-small']).text('by ');\n      item.signTextZone = $touch('a', ['link', 'x-small']);\n      item.identityTextZone = $touch('div', ['text', 'x-small']);\n      item.warnTextZone = $touch('div', ['text', 'x-small', 'warn']);\n      item.on('click', () => selectItem(item, this.items));\n      this.items.push(item);\n      return item;\n    });\n    defineProperty(infoZone)('flush', function () {\n      this.html('');\n      this.items = [];\n      return this;\n    });\n\n    const dropZone = body.dropZone = $touch('div', 'dropZoneContainer');\n    dropZone.inputContainer = $touch('div');\n    dropZone.inputContainer.mainTextZone = $touch('div', ['text', 'small']);\n    dropZone.inputContainer.subTextZone = $touch('div', ['text', 'x-small']);\n    dropZone.inputContainer.input = $touch('input', ['dropZone', 'clickable']).attr('type', 'file').on('change', setInputFile);\n\n    const foot = widget.foot = $touch('div', 'foot');\n    foot.expand = $touch('div', ['expand', 'expand-button', 'clickable']).on('click', expandList);\n\n    init();\n\n    // Simulate a drop if hash is provided\n    if (hash) setInputFile.call({ files: [hash] });\n\n    function init() {\n      resetText();\n      dropZone.inputContainer.mainTextZone.text('Drop the file to verify');\n      infoZone.removeClass(['ok', 'error', 'info']);\n      infoZone.hide();\n      dropZone.show();\n      hashZone.hide();\n      head.x.reset.hide();\n      head.x.cancel.hide();\n      head.x.receipt.hide();\n      foot.hide();\n    }\n\n    function resetText() {\n      dropZone.inputContainer.mainTextZone.clear();\n      dropZone.inputContainer.subTextZone.clear();\n      infoZone.flush();\n    }\n\n    /**\n     * @param {Date} date\n     */\n    function formatDate(date) {\n      let options = { year: 'numeric', month: 'short', day: 'numeric', hour: 'numeric', minute: 'numeric' };\n      return date.toLocaleDateString('en', options)\n    }\n\n    const hasher = new woleet.file.Hasher;\n\n    function setInputFile() {\n      let file = this.files[0];\n      if (!file) return;\n\n      // Set default vue\n      if (state.state === 'done') setVue('init');\n\n      const setProgress = (e) => {\n        let p = (e.progress * 100);\n        if (p !== p) p = 0;\n        p = p.toFixed(0);\n        progressBar.style({ width: p + '%' });\n        hashZone.percentage.text('Hashing... ' + p + '%');\n      };\n\n      // We need a receipt to verify the hash|file\n      if (state.state === 'needReceipt') {\n\n        return parseReceiptFile(file)\n          .then((receipt) => woleet.verify.DAB(state.hash, receipt, setProgress))\n          .then((res) => {\n            if (res.code !== 'verified') {\n              throw new Error(res.code);\n            }\n            setVue('ok', res);\n            state.state = 'done';\n          })\n          .catch((err) => {\n            setVue('error', err);\n          })\n      }\n\n      // We just entered a new hash|file to verify\n      else {\n\n        if (typeof file === 'string') {\n          state.hash = file;\n          return woleetDAB(state.hash);\n        } else {\n\n          setVue('hashing');\n\n          return new Promise((resolve, reject) => {\n            hasher.start(file);\n            hasher.on('progress', setProgress);\n            hasher.on('error', (err) => setVue('error', err.error || err.message));\n            hasher.on('result', (r) => {\n              state.hash = r.result;\n              setProgress({ progress: 0 });\n              resolve(woleetDAB(state.hash));\n            })\n          })\n        }\n\n        function woleetDAB(hash) {\n\n          setVue('pending', 'Verifying proof(s)... ');\n\n          return woleet.verify.WoleetDAB(hash, setProgress)\n            .then((results) => {\n              state.state = 'done';\n              addResults(results.sort((b, a) => a.timestamp > b.timestamp ? -1 : a.timestamp < b.timestamp ? 1 : 0));\n            })\n            .catch((err) => {\n              // As we use cross-domain, it is difficult to know where the error come from,\n              // so we guess that the Woleet API isn't available and set state to need-receipt\n              // if the error came from network\n              if (err.hasOwnProperty('code') || err.message === 'need-receipt') {\n                state.state = 'needReceipt';\n                setVue('need-receipt');\n              } else {\n                setVue('error', err);\n              }\n            })\n        }\n      }\n    }\n\n    function forceReceipt() {\n      resetText();\n      foot.hide();\n      state.state = 'needReceipt';\n      setVue('need-receipt');\n      dropZone.inputContainer.mainTextZone.text('Drop the proof receipt');\n      dropZone.inputContainer.subTextZone.clear();\n    }\n\n    function getDetailedMessage(error) {\n      const detail = {};\n      switch (error) {\n        case 'need-receipt':\n          detail.main = 'No public proof found at Woleet';\n          detail.sub = 'No public proof receipt found at Woleet: you must provide one to verify this file';\n          break;\n        case 'file_matched_but_anchor_not_yet_processed':\n          detail.main = 'The proof is not yet verifiable';\n          detail.sub = 'A public proof receipt has been found at Woleet, but is not yet verifiable (try again later)';\n          break;\n        case 'target_hash_mismatch':\n          detail.main = 'The proof mismatches the file';\n          detail.sub = 'The proof receipt\\'s target hash attribute doesn\\'t match the file hash';\n          break;\n        case 'unable_to_parse_json':\n          detail.main = 'The proof cannot be parsed';\n          detail.sub = 'The file you provided is not a valid Chainpoint 1 or 2 proof receipt';\n          break;\n        case 'merkle_root_mismatch':\n          detail.main = 'The proof is corrupted';\n          detail.sub = 'The proof receipt\\'s merkle root attribute does not match the proof result';\n          break;\n        case 'non_sha256_target_proof_element':\n          detail.main = 'The proof is corrupted';\n          detail.sub = 'An attribute in the proof (parent or left or right) in not a SHA256 hash';\n          break;\n        case 'invalid_parent_in_proof_element':\n          detail.main = 'The proof is corrupted';\n          detail.sub = 'A parent in the proof is not the SHA256 of its children';\n          break;\n        case 'invalid_receipt_format':\n          detail.main = 'The proof is corrupted';\n          detail.sub = 'The proof receipt does not conform to the Chainpoint 1 or 2 format';\n          break;\n        case 'invalid_target_proof':\n          detail.main = 'The proof is corrupted';\n          detail.sub = 'The proof receipt\\'s merkle proof attribute is invalid';\n          break;\n        case 'op_return_mismatches_merkle_root':\n          detail.main = 'The receipt is corrupted';\n          detail.sub = 'The transaction\\'s OP_RETURN mismatches the proof receipt\\'s merkle root';\n          break;\n        case 'http_error':\n          detail.main = 'Unexpected HTTP error';\n          detail.sub = 'An unexpected HTTP error occurred during the verification process';\n          break;\n        case 'tx_not_found':\n          detail.main = 'The transaction cannot be found';\n          detail.sub = 'The proof receipt\\'s transaction doesn\\'t exist in the blockchain';\n          break;\n        case 'tx_not_confirmed':\n          detail.main = 'The transaction is not confirmed';\n          detail.sub = 'The proof receipt\\'s transaction is not yet confirmed by the blockchain';\n          break;\n        case 'invalid_receipt_signature':\n          detail.main = 'The signature is invalid';\n          detail.sub = 'The proof receipt\\'s signature is not valid';\n          break;\n        case 'invalid_receipt_signature_format':\n          detail.main = 'The signature is corrupted';\n          detail.sub = 'The proof receipt does not conform to the Chainpoint 1 or 2 format with signature extension';\n          break;\n        case 'file_too_big_to_be_hashed_without_worker':\n          detail.main = 'Cannot hash without worker';\n          detail.sub = 'The file is too big to be hashed without worker';\n          break;\n        default:\n          console.trace('unexpected case', error);\n          detail.main = error;\n          detail.sub = 'Unexpected case';\n          break;\n      }\n      return detail;\n    }\n\n    function addResults(results) {\n      resetText();\n      if (results.length) {\n\n        if (results.length > 1) {\n          foot.expand.text(results.length + '+');\n          foot.expand.removeClass('up-arrow');\n          foot.show();\n        }\n\n        results.forEach((res, i) => {\n          if (res.code === 'verified') {\n            addVue('ok', res, i);\n          } else {\n            addVue('error', res.code, i);\n          }\n        });\n        infoZone.toDom();\n      } else {\n        state.state = 'needReceipt';\n        setVue('need-receipt');\n      }\n    }\n\n    function addVue(vue, message, index) {\n      infoZone.show();\n      const item = infoZone.addItem();\n      item.addClass(index ? 'reduced' : 'expanded');\n      dropZone.hide();\n      hashZone.hide();\n      head.x.cancel.hide();\n      switch (vue) {\n        case 'ok':\n          const sig = message.receipt.signature;\n          const pubKey = sig ? sig.pubKey : null;\n\n          // Timestamp\n          if (!message.confirmations) {\n            item.mainTextZone.text('Proof not yet verifiable');\n            item.subTextZone.text('The proof receipt\\'s transaction is not yet confirmed (try again later)');\n            item.addClass('info');\n          } else {\n            const date = formatDate(message.timestamp);\n            item.mainTextZone.text(`${pubKey ? 'Signed' : 'Timestamped'} on ${date}`);\n            item.addClass('ok');\n          }\n\n          // Identity\n          const idStatus = message.identityVerificationStatus;\n          const identity = idStatus ? Object.assign({}, idStatus.signedIdentity, idStatus.identity) : null;\n          if (idStatus && idStatus.code === 'verified' && identity) {\n            item.byTextZone.addClass('link');\n            if (sig.identityURL)\n              item.signTextZone.link(`${sig.identityURL}?pubKey=${pubKey}&leftData=random`\n                + (sig.signedIdentity ? `&signedIdentity=${encodeURIComponent(sig.signedIdentity)}` : ''));\n            if (identity && identity.commonName) {\n              item.signTextZone.text(`${identity.commonName}`);\n              item.identityTextZone.html(\n                `${identity.organization || ''}${identity.organization && identity.organizationalUnit ? ' - ' : ''}${identity.organizationalUnit || ''}<br>\n                 ${identity.locality || ''}${identity.locality && identity.country ? ' - ' : ''}${identity.country || ''}`\n              );\n            } else {\n              item.signTextZone.text(`${sig.identityURL}`);\n            }\n            item.byTextZone.show();\n          } else if (pubKey) {\n            item.signTextZone.text(`${pubKey}`);\n            item.byTextZone.show();\n          } else {\n            item.byTextZone.hide();\n          }\n          if (idStatus && idStatus.code && idStatus.code !== 'verified') {\n            item.warnTextZone.text(`Cannot verify identity (${idStatus.code})`)\n          }\n\n          dropZone.attr('disabled', true);\n          head.x.receipt.show();\n          break;\n        case 'error':\n          if (state.state === 'needReceipt') head.x.receipt.show();\n          const error = (message instanceof Error) ? message.message : message;\n          const detail = getDetailedMessage(error);\n          item.mainTextZone.text(detail.main);\n          item.subTextZone.text(detail.sub);\n          item.byTextZone.hide();\n          item.warnTextZone.hide();\n          item.addClass(error !== 'file_matched_but_anchor_not_yet_processed' ? 'error' : 'info');\n          break;\n      }\n      head.x.reset.show();\n    }\n\n    function setVue(vue, message) {\n      switch (vue) {\n        case 'ok':\n          resetText();\n          addVue('ok', message, 0);\n          infoZone.toDom();\n          break;\n        case 'need-receipt':\n          resetText();\n          infoZone.hide();\n          dropZone.show();\n          hashZone.hide();\n          head.x.cancel.hide();\n          head.x.receipt.hide();\n          dropZone.inputContainer.mainTextZone.text('No public proof found at Woleet');\n          dropZone.inputContainer.subTextZone.text('Please provide a proof receipt');\n          head.x.reset.show();\n          break;\n        case 'error':\n          resetText();\n          addVue('error', message, 0);\n          infoZone.toDom();\n          break;\n        case 'hashing':\n          resetText();\n          head.x.cancel.show();\n          head.x.receipt.hide();\n          infoZone.hide();\n          dropZone.hide();\n          hashZone.show();\n          break;\n        case 'pending':\n          resetText();\n          infoZone.hide();\n          dropZone.show();\n          hashZone.hide();\n          head.x.cancel.hide();\n          head.x.receipt.hide();\n          dropZone.inputContainer.mainTextZone.text(message);\n          head.x.reset.show();\n          break;\n        case 'init':\n        default:\n          init();\n          break;\n      }\n    }\n\n    function parseReceiptFile(receipt) {\n      return new Promise((resolve, reject) => {\n        let reader = new FileReader();\n        reader.onloadend = (e) => {\n          try {\n            resolve(JSON.parse(e.target.result));\n          }\n          catch (err) {\n            reject(new Error('unable_to_parse_json'));\n          }\n        };\n        reader.readAsText(receipt);\n      });\n    }\n\n    let expanded = false;\n    let selected = null;\n\n    function selectItem(item, items) {\n      if (!expanded) return;\n\n      if (selected === item) {\n        // Clicked on item for the second time\n        return expandList();\n      }\n\n      selected = item;\n\n      items.forEach((item) => {\n        item.removeClass('expanded');\n        item.addClass('reduced');\n      });\n\n      item.addClass('expanded');\n      item.removeClass('reduced');\n    }\n\n    function expandList() {\n      const items = infoZone.items;\n      if (expanded) {\n        body.removeClass('expanded');\n        items.forEach((item) => item.removeClass('clickable'));\n        foot.expand.text(items.length + \"+\");\n        foot.expand.removeClass(\"up-arrow\");\n        expanded = false;\n      } else {\n        body.addClass('expanded');\n        items.forEach((item) => item.addClass('clickable'));\n        foot.expand.text('');\n        foot.expand.addClass('up-arrow');\n        expanded = true;\n      }\n    }\n\n    function reset() {\n      setVue('init');\n      hasher.cancel();\n      state.hash = null;\n      state.state = 'initial'\n    }\n\n    function cancelHash() {\n      reset();\n    }\n\n    this.setInputFile = (file) => {\n      if (state.state === 'needReceipt')\n        throw new Error('Current state is needReceipt');\n      const ctx = { files: [file] };\n      return setInputFile.call(ctx);\n    };\n\n    this.setReceipt = (file) => {\n      forceReceipt();\n      if (state.state !== 'needReceipt')\n        throw new Error('Current state must be needReceipt');\n      const ctx = { files: [file] };\n      return setInputFile.call(ctx);\n    };\n\n    this.reset = reset;\n\n    this.cancelHash = cancelHash;\n\n    this.toDom = () => widget.toDom();\n  }\n\n  document.addEventListener(\"DOMContentLoaded\", () => {\n    let widgets = document.getElementsByClassName(\"woleet-widget\");\n    for (let i = 0; i < widgets.length; i++) {\n      let e = widgets[i];\n      let hash = e.getAttribute(\"data-hash\");\n      const widget = new Widget(hash);\n      e.appendChild(widget.toDom());\n    }\n  });\n\n  root.Widget = Widget;\n\n}(window));\n"],"file":"woleet-widget.js"}